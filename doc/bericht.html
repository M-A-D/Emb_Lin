<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.11: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7614 2013-02-21 15:55:51Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

body { 
    margin-left:  100px; 
    margin-right: 100px;
}


/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">























<img src="img/hsa-logo.jpg" width="200" 
     alt="Logo der Hochschule Augsburg" align=right vspace="0">

<p>

<h2>Embedded Linux - Geocaching Modul
</h2>

Embedded Linux<br>
Hochschule Augsburg <br>
Fakultät für Informatik (Prof. Dr. Hubert Högl) <br>
Studiengang Technische Informatik, 6. Semester <br>

Sommersemester 2015
 <br>
<!-- print date -->
Datum: 2015-05-06 16:53

<p>

Matthias Pfitzmayer, &lt;matthias.pfitzmayer@hs-augsburg.de&gt;,  #935691 <br>
Daniel Schneider, &lt;daniel.schneider@hs-augsburg.de&gt;,  # <br>
Matthias Struwe, &lt;matthias.struwe@hs-augsburg.de&gt;,  # <br>

<hr>
<img src=img/cc-logo.jpg width="150" alt="cc-logo"><br>
Dieser Text steht unter der Creative Commons Lizenz 
<a href="http://creativecommons.org/licenses/by-nc/3.0/de/">"Namensnennung/Keine kommerizelle Nutzung"<a/>


<center>
          <h2>
Geocaching Modul
</h2>
</center>


<div class="contents topic" id="inhalt">
<p class="topic-title first">Inhalt</p>
<ul class="auto-toc simple">
<li><a class="reference internal" href="#beschreibung-der-hardware" id="id7">1&nbsp;&nbsp;&nbsp;Beschreibung der Hardware</a><ul class="auto-toc">
<li><a class="reference internal" href="#verbindung" id="id8">1.1&nbsp;&nbsp;&nbsp;Verbindung</a></li>
<li><a class="reference internal" href="#blockschaltplan-beaglebone-black" id="id9">1.2&nbsp;&nbsp;&nbsp;Blockschaltplan Beaglebone Black</a></li>
<li><a class="reference internal" href="#komponenten" id="id10">1.3&nbsp;&nbsp;&nbsp;Komponenten</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bau-einer-eigenen-linuxumgebung-mit-dem-yoctoproject" id="id11">2&nbsp;&nbsp;&nbsp;Bau einer eigenen Linuxumgebung mit dem Yoctoproject</a><ul class="auto-toc">
<li><a class="reference internal" href="#herunterladen-der-yocto-buildumgebung" id="id12">2.1&nbsp;&nbsp;&nbsp;Herunterladen der Yocto Buildumgebung</a><ul class="auto-toc">
<li><a class="reference internal" href="#von-github-des-yoctoproject" id="id13">2.1.1&nbsp;&nbsp;&nbsp;Von Github des Yoctoproject</a></li>
<li><a class="reference internal" href="#herunterladen-des-aktuellen-images-von-der-webseite-des-yoctoproject" id="id14">2.1.2&nbsp;&nbsp;&nbsp;Herunterladen des aktuellen images von der webseite des Yoctoproject</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bauen-des-yocto-core-images-und-des-bootloaders" id="id15">2.2&nbsp;&nbsp;&nbsp;Bauen des Yocto-core-images und des Bootloaders</a><ul class="auto-toc">
<li><a class="reference internal" href="#erstellen-der-buildumgebung-und-uberprufung-der-variablen" id="id16">2.2.1&nbsp;&nbsp;&nbsp;Erstellen der Buildumgebung und Überprüfung der Variablen</a></li>
<li><a class="reference internal" href="#anpassungen-in-der-datei-local-conf" id="id17">2.2.2&nbsp;&nbsp;&nbsp;Anpassungen in der Datei &quot;local.conf&quot;</a></li>
<li><a class="reference internal" href="#bitbake-eine-build-umgebung-fur-ein-angepasstes-yocto-linux" id="id18">2.2.3&nbsp;&nbsp;&nbsp;Bitbake eine Build-umgebung für ein angepasstes Yocto-linux</a></li>
<li><a class="reference internal" href="#hob-und-toaster-graphische-oberflachen-fur-die-konfiguration-von-yocto" id="id19">2.2.4&nbsp;&nbsp;&nbsp;hob und toaster - graphische Oberflächen für die Konfiguration von Yocto</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#vorbereiten-der-microsd-karte" id="id20">3&nbsp;&nbsp;&nbsp;Vorbereiten der microSD Karte</a><ul class="auto-toc">
<li><a class="reference internal" href="#boot-formatieren-als-fat16-lba" id="id21">3.1&nbsp;&nbsp;&nbsp;boot formatieren als FAT16 (LBA)</a></li>
<li><a class="reference internal" href="#root-als-linux-formatieren" id="id22">3.2&nbsp;&nbsp;&nbsp;root als &quot;Linux&quot; formatieren</a></li>
<li><a class="reference internal" href="#die-anderungen-auf-der-sd-karte-anwenden" id="id23">3.3&nbsp;&nbsp;&nbsp;Die Änderungen auf der SD Karte anwenden</a></li>
<li><a class="reference internal" href="#anlegen-des-filesystem-und-der-partitionstabelle" id="id24">3.4&nbsp;&nbsp;&nbsp;Anlegen des Filesystem und der Partitionstabelle</a><ul class="auto-toc">
<li><a class="reference internal" href="#boot-partition" id="id25">3.4.1&nbsp;&nbsp;&nbsp;&quot;boot-Partition&quot;</a></li>
<li><a class="reference internal" href="#root-partition" id="id26">3.4.2&nbsp;&nbsp;&nbsp;&quot;root-Partition&quot;</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#platzieren-der-daten-auf-der-sd-karte" id="id27">4&nbsp;&nbsp;&nbsp;Platzieren der Daten auf der SD-Karte</a><ul class="auto-toc">
<li><a class="reference internal" href="#instalation-des-bootloaders" id="id28">4.1&nbsp;&nbsp;&nbsp;Instalation des Bootloaders</a></li>
<li><a class="reference internal" href="#kopieren-und-entpacken-des-filesystems" id="id29">4.2&nbsp;&nbsp;&nbsp;Kopieren und Entpacken des Filesystems</a></li>
</ul>
</li>
<li><a class="reference internal" href="#das-u-boot" id="id30">5&nbsp;&nbsp;&nbsp;Das u-boot</a><ul class="auto-toc">
<li><a class="reference internal" href="#einstellungen-von-u-boot-uberprufen" id="id31">5.1&nbsp;&nbsp;&nbsp;Einstellungen von u-boot überprüfen</a></li>
<li><a class="reference internal" href="#zugriff-auf-das-serielle-terminal-wahrend-des-bootvorganges" id="id32">5.2&nbsp;&nbsp;&nbsp;Zugriff auf das serielle Terminal während des Bootvorganges</a></li>
</ul>
</li>
<li><a class="reference internal" href="#netboot-test" id="id33">6&nbsp;&nbsp;&nbsp;Netboot test</a></li>
<li><a class="reference internal" href="#debian-8-0-fur-das-beaglebone-black" id="id34">7&nbsp;&nbsp;&nbsp;Debian 8.0 für das BeagleBone Black</a><ul class="auto-toc">
<li><a class="reference internal" href="#die-ersten-schritte-nach-dem-erfolgreichen-platzieren-des-images" id="id35">7.1&nbsp;&nbsp;&nbsp;Die ersten Schritte nach dem erfolgreichen platzieren des images:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#einrichten-eines-accesspoint-auf-dem-beaglebone-black" id="id36">8&nbsp;&nbsp;&nbsp;Einrichten eines Accesspoint auf dem BeagleBone Black</a><ul class="auto-toc">
<li><a class="reference internal" href="#einrichten-des-w-lan-interfaces" id="id37">8.1&nbsp;&nbsp;&nbsp;Einrichten des W-Lan Interfaces</a></li>
<li><a class="reference internal" href="#konfiguration-des-hostapd" id="id38">8.2&nbsp;&nbsp;&nbsp;Konfiguration des hostapd</a></li>
<li><a class="reference internal" href="#konfiguration-des-isc-dhcp-servers" id="id39">8.3&nbsp;&nbsp;&nbsp;Konfiguration des isc-dhcp-servers</a></li>
<li><a class="reference internal" href="#erstellen-einer-dns-maske-zur-weiterleiten-einer-bestehenden-netzwerkverbindung" id="id40">8.4&nbsp;&nbsp;&nbsp;Erstellen einer DNS-Maske zur weiterleiten einer bestehenden Netzwerkverbindung</a></li>
</ul>
</li>
<li><a class="reference internal" href="#gpio" id="id41">9&nbsp;&nbsp;&nbsp;GPIO</a><ul class="auto-toc">
<li><a class="reference internal" href="#verwendung-des-sogenannten-sysfs" id="id42">9.1&nbsp;&nbsp;&nbsp;Verwendung des sogenannten &quot;sysfs&quot;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tools-und-programme" id="id43">10&nbsp;&nbsp;&nbsp;Tools und Programme</a><ul class="auto-toc">
<li><a class="reference internal" href="#minicom-ein-serial-terminal-emulator" id="id44">10.1&nbsp;&nbsp;&nbsp;Minicom ein serial Terminal Emulator</a><ul class="auto-toc">
<li><a class="reference internal" href="#installation" id="id45">10.1.1&nbsp;&nbsp;&nbsp;Installation</a></li>
<li><a class="reference internal" href="#unter-a-das-richtige-device-einrichten" id="id46">10.1.2&nbsp;&nbsp;&nbsp;Unter A das richtige Device einrichten</a></li>
<li><a class="reference internal" href="#als-default-speichern" id="id47">10.1.3&nbsp;&nbsp;&nbsp;Als default Speichern</a></li>
<li><a class="reference internal" href="#minicom-beenden-und-neu-starten" id="id48">10.1.4&nbsp;&nbsp;&nbsp;Minicom beenden und neu starten</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fdisk-partitionierungs-tool" id="id49">10.2&nbsp;&nbsp;&nbsp;fdisk partitionierungs tool</a><ul class="auto-toc">
<li><a class="reference internal" href="#laufwerk-auswahlen" id="id50">10.2.1&nbsp;&nbsp;&nbsp;Laufwerk auswählen</a></li>
<li><a class="reference internal" href="#laufwerksinformationen-ausgeben" id="id51">10.2.2&nbsp;&nbsp;&nbsp;Laufwerksinformationen ausgeben</a></li>
<li><a class="reference internal" href="#sonstige-befehle" id="id52">10.2.3&nbsp;&nbsp;&nbsp;Sonstige Befehle</a></li>
<li><a class="reference internal" href="#unterschiedliche-formatierungen" id="id53">10.2.4&nbsp;&nbsp;&nbsp;Unterschiedliche Formatierungen</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lighttpd-ein-leichtgewichtiger-http-server" id="id54">10.3&nbsp;&nbsp;&nbsp;lighttpd - ein leichtgewichtiger http-server</a></li>
</ul>
</li>
<li><a class="reference internal" href="#literatur-und-sonstige-quellen" id="id55">11&nbsp;&nbsp;&nbsp;Literatur und sonstige Quellen</a></li>
</ul>
</div>
<div class="section" id="beschreibung-der-hardware">
<h1><a class="toc-backref" href="#id7">1&nbsp;&nbsp;&nbsp;Beschreibung der Hardware</a></h1>
<p>Für das Projekt wird das Beaglebone Black verwendet. Gründe hierfür sind der günstige Preis, die gute Verarbeitung und die hohe Leistung bei relativ geringem Energiebedarf.</p>
<p>Zunächst werden wir uns einmal mit der Hard- und Software im Orginalzustand wittmen. Verbindet man ein neues Beaglebone Black via USB mit dem Host-/Entwicklungsrechner so wird eine weitere Netzwerkverbindung geöffnet. Über diese kann man via ssh eine Verbindung zum Target starten.</p>
<pre class="code bash literal-block">
ssh debian&#64;192.168.7.2
<span class="comment"># pwd: temppwd</span>
</pre>
<div class="figure align-center">
<img alt="img/ssh-BBB.png" src="img/ssh-BBB.png" />
</div>
<p>Es befindet sich bereits eine angepasste Debian Version Linux beaglebone 3.8.13-bone47 auf dem 4 GB großen eMMC Speicher. Es wird per default von der eMMC gebootet und unter Verwendung von Maus, Tastatur und Display könnte man das BBB wie einen  rechenpower armen PC verwenden.</p>
<!-- cat /proc/cpuinfo -->
<!-- cat /proc/meminfo -->
<!-- cat /proc/version -->
<!-- cat /lib/libc.so -->
<!-- bootloader -->
<!-- printenv -->
<!--  -->
<!-- hush.c - shell -->
<div class="section" id="verbindung">
<h2><a class="toc-backref" href="#id8">1.1&nbsp;&nbsp;&nbsp;Verbindung</a></h2>
<pre class="code bash literal-block">
debian&#64;beaglebone:~# ifconfig
debian&#64;beaglebone:~# dhclient eth0
</pre>
<div class="figure align-center">
<img alt="img/ssh-ifconfig-BBB.png" src="img/ssh-ifconfig-BBB.png" />
</div>
</div>
<div class="section" id="blockschaltplan-beaglebone-black">
<h2><a class="toc-backref" href="#id9">1.2&nbsp;&nbsp;&nbsp;Blockschaltplan Beaglebone Black</a></h2>
<div class="figure align-center">
<img alt="img/BBB-Blockschaltplan.png" src="img/BBB-Blockschaltplan.png" />
</div>
</div>
<div class="section" id="komponenten">
<h2><a class="toc-backref" href="#id10">1.3&nbsp;&nbsp;&nbsp;Komponenten</a></h2>
<div class="figure align-center">
<img alt="img/BBB-components.png" src="img/BBB-components.png" />
</div>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Komponenten</th>
<th class="head">Model / Ausführung</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>CPU</td>
<td>Sitara AM3358BZCZ100 ARM® Cortex-A8
1GHz  dual-core mit 2000 MIPS</td>
</tr>
<tr><td>RAM</td>
<td>512 MB DDR3L &#64; 800 MHz</td>
</tr>
<tr><td>ROM</td>
<td>4 GB eMMC</td>
</tr>
<tr><td>IPU</td>
<td>4 x ARM® Cortex-M4</td>
</tr>
<tr><td>GPU</td>
<td><ul class="first last simple">
<li>PowerVR SGX544 dual core (3D)</li>
<li>Vivante GC320 core       (2D)</li>
</ul>
</td>
</tr>
<tr><td>Power Source</td>
<td><ul class="first last simple">
<li>mini USB DC Jack</li>
<li>5 V DC Jack</li>
<li>TPS65217C PMIC</li>
<li>LDO</li>
</ul>
</td>
</tr>
<tr><td>User Input</td>
<td><ul class="first last simple">
<li>Reset Button</li>
<li>Boot Button</li>
<li>Power Button</li>
</ul>
</td>
</tr>
<tr><td>Connectors</td>
<td><ul class="first last simple">
<li>RJ-45 Ethernet 10 / 100</li>
<li>USB-A (2.0), mini USB</li>
<li>mini HDMI (audio / video)</li>
<li>microSD (3,3V)</li>
<li>VDD_ADC (1,8V)</li>
<li>GPIO    (3,3V)</li>
<li>SPI</li>
<li>I2C</li>
<li>UART</li>
<li>JTAG (20 pin Onboard Header)</li>
<li>MMC1, MMC2</li>
<li>4 Timer</li>
<li>CAN</li>
<li>XDMA Interrupt</li>
<li>LCD</li>
<li>Expansion Board ID</li>
</ul>
</td>
</tr>
<tr><td>PCB</td>
<td><ul class="first last simple">
<li>3,4&quot; x 2,1&quot;</li>
<li>6 Layer</li>
<li>39,68 g</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><a class="citation-reference" href="#bbb-bsp" id="id1">[BBB-BSP]</a></p>
</div>
</div>
<div class="section" id="bau-einer-eigenen-linuxumgebung-mit-dem-yoctoproject">
<h1><a class="toc-backref" href="#id11">2&nbsp;&nbsp;&nbsp;Bau einer eigenen Linuxumgebung mit dem Yoctoproject</a></h1>
<p>Zu Begin soll eine neue angepasste Linuxumgebung für das Beagelbone Black compiliert und auf der MicroSD-Karte platziert werden. Hierzu bedienen wir uns im ersten Teil des Yoctoproject. Bei diesem handelt es sich um eine vereinfachte Version von &quot;&quot;. Yocto wurde in den letzten Jahren zu einem wichtigen Standard in der Wirtschaft. Yocto ermöglicht den einfachen Bau von minimale angepasste Linux-distributionen für das eigene Board. Außerdem unterstützt es die Erstellung eines eigenen Paket-servers von dem aus mit dem Paketmanager &quot;smart&quot; updates auf allen Boards durchgeführt werden können. <a class="citation-reference" href="#bbb-yocto" id="id2">[BBB-YOCTO]</a></p>
<p>Für den Bau der Yocto-distribution empfiehlt sich die Verwendung einer erprobten Linux Distribution. Wir haben Ubuntu 14.04 LTS-Version für den folgenden Bauversuch verwendet. Bevor mit dem Bauen einer eigenen Linux Distribution begonnen werden konnte mussten noch die folgenden Pakete nachinstalliert werden:</p>
<pre class="code bash literal-block">
<span class="comment"># simple-directmedia-layer - Crossplattform Bibliothek
</span>sudo apt-get install libsdl1.2-dev
<span class="comment"># change-run-path
</span>sudo apt-get install chrpath
<span class="comment"># texinfo - gnu Dokumentations System
</span>sudo apt-get install texinfo
<span class="comment"># GNU - AWaKe
</span>sudo apt-get install gawk
<span class="comment"># diffstat - make histogramm
</span>sudo apt-get install diffstat
<span class="comment"># GNU C++ - Compiler
</span>sudo apt-get install g++
</pre>
<div class="section" id="herunterladen-der-yocto-buildumgebung">
<h2><a class="toc-backref" href="#id12">2.1&nbsp;&nbsp;&nbsp;Herunterladen der Yocto Buildumgebung</a></h2>
<div class="section" id="von-github-des-yoctoproject">
<h3><a class="toc-backref" href="#id13">2.1.1&nbsp;&nbsp;&nbsp;Von Github des Yoctoproject</a></h3>
<pre class="code bash literal-block">
    git colone git://git.yoctoproject.org/meta-yocto -b &lt;VERSION&gt;
    <span class="comment"># aktuelle Version zum Zeitpunkt des Projektbeginns war Dizzy
</span>git clone git://git.yoctoproject.org/meta-yocto -b dizzy
</pre>
</div>
<div class="section" id="herunterladen-des-aktuellen-images-von-der-webseite-des-yoctoproject">
<h3><a class="toc-backref" href="#id14">2.1.2&nbsp;&nbsp;&nbsp;Herunterladen des aktuellen images von der webseite des Yoctoproject</a></h3>
<p><a class="citation-reference" href="#todo" id="id3">[TODO]</a></p>
<!-- add a description and the link -->
<pre class="code bash literal-block">
wget http://downloads.yoctoproject.org/releases/yocto/yocto-1.7/machines/beaglebone/beaglebone-dizzy-12.0.0.tar.bz2
</pre>
</div>
</div>
<div class="section" id="bauen-des-yocto-core-images-und-des-bootloaders">
<h2><a class="toc-backref" href="#id15">2.2&nbsp;&nbsp;&nbsp;Bauen des Yocto-core-images und des Bootloaders</a></h2>
<div class="section" id="erstellen-der-buildumgebung-und-uberprufung-der-variablen">
<h3><a class="toc-backref" href="#id16">2.2.1&nbsp;&nbsp;&nbsp;Erstellen der Buildumgebung und Überprüfung der Variablen</a></h3>
<p>Nachdem herunterladen und entpacken kann mit dem Bau begonnen werden. Dafür wechselt man in das Verzeichnis &quot;poky/&quot;. In diesem Verzeichnis befinden sich die Sources und Konfigurations-Dateien, die für den Bauvorgang benötigt werden. Vor jedem neuen Bauvorgang sollte die Buildumgebung gesourced werden. Dies sorgt dafür das die für den Bau benötigten Variablen, wie zum Beispiel Compiler, Kernel und Architekturen im jeweiligen Terminal gesetzt werden. Wechselt man das Terminal muss die Buildumgebung erneut gesourced werden. Eine weitere wichtige Anmerkung, je nach Konfiguration wird für das Bauen zwischen 10 und 25 GB Speicherplatz benötigt, läuft dieser voll bricht der Bauvorgang einfach ab!</p>
<pre class="code bash literal-block">
<span class="name builtin">source </span>oe-init-build-env build
<span class="comment"># oder
</span>. oe-init-build-env build
<span class="comment"># anzeigen verschiedener vorkonfigurierter &quot;Rezepte&quot;
</span>bitbake-layers show-recipes
</pre>
<p>Der Ordner &quot;build&quot; wurde angelegt und außerdem ist das Terminal gleich in diesen gewechselt. In diesem Ordner befindet sich der Unterordner &quot;conf&quot; und in diesem die Datei &quot;local.conf&quot; diese datei einthält unter anderem Informationen darüber für welches Target das Yocto Image gebaut werden soll. Um den Build-Prozess anstoßen zu können muss sie allerdings noch angepasst werden.</p>
</div>
<div class="section" id="anpassungen-in-der-datei-local-conf">
<h3><a class="toc-backref" href="#id17">2.2.2&nbsp;&nbsp;&nbsp;Anpassungen in der Datei &quot;local.conf&quot;</a></h3>
<pre class="code bash literal-block">
<span class="comment">#
# This file is your local configuration file and is where all local user settings
# are placed. The comments in this file give some guide to the options a new user
# to the system might want to change but pretty much any configuration option can
# be set in this file. More adventurous users can look at local.conf.extended
# which contains other examples of configuration which can be placed in this file
# but new users likely won't need any of them initially.
#
# Lines starting with the '#' character are commented out and in some cases the
# default values are provided as comments to show people example syntax. Enabling
# the option is a question of removing the # character and making any change to the
# variable as required.
</span>
<span class="comment">#
# Machine Selection
#
# You need to select a specific machine to target the build with. There are a selection
# of emulated machines available which can boot and run in the QEMU emulator:
#
#MACHINE ?= &quot;qemuarm&quot;
#MACHINE ?= &quot;qemumips&quot;
#MACHINE ?= &quot;qemuppc&quot;
#MACHINE ?= &quot;qemux86&quot;
#MACHINE ?= &quot;qemux86-64&quot;
#
# There are also the following hardware board target machines included for
# demonstration purposes:
#
</span>
<span class="comment"># [1.] removed the '#' in front of 'MACHINE ?= &quot;beaglebone&quot;'
</span>
MACHINE ?<span class="operator">=</span> <span class="literal string double">&quot;beaglebone&quot;</span>
<span class="comment">#MACHINE ?= &quot;genericx86&quot;
#MACHINE ?= &quot;genericx86-64&quot;
#MACHINE ?= &quot;mpc8315e-rdb&quot;
#MACHINE ?= &quot;edgerouter&quot;
#
# This sets the default machine to be qemux86 if no other machine is selected:
</span>MACHINE ??<span class="operator">=</span> <span class="literal string double">&quot;qemux86&quot;</span>

<span class="comment">#
# Where to place downloads
#
# During a first build the system will download many different source code tarballs
# from various upstream projects. This can take a while, particularly if your network
# connection is slow. These are all stored in DL_DIR. When wiping and rebuilding you
# can preserve this directory to speed up this part of subsequent builds. This directory
# is safe to share between multiple builds on the same machine too.
#
# The default is a downloads directory under TOPDIR which is the build directory.
#
#DL_DIR ?= &quot;${TOPDIR}/downloads&quot;
</span>
<span class="comment">#
# Where to place shared-state files
#
# BitBake has the capability to accelerate builds based on previously built output.
# This is done using &quot;shared state&quot; files which can be thought of as cache objects
# and this option determines where those files are placed.
#
# You can wipe out TMPDIR leaving this directory intact and the build would regenerate
# from these files if no changes were made to the configuration. If changes were made
# to the configuration, only shared state files where the state was still valid would
# be used (done using checksums).
#
# The default is a sstate-cache directory under TOPDIR.
#
#SSTATE_DIR ?= &quot;${TOPDIR}/sstate-cache&quot;
</span>
<span class="comment">#
# Where to place the build output
#
# This option specifies where the bulk of the building work should be done and
# where BitBake should place its temporary files and output. Keep in mind that
# this includes the extraction and compilation of many applications and the toolchain
# which can use Gigabytes of hard disk space.
#
# The default is a tmp directory under TOPDIR.
#
#TMPDIR = &quot;${TOPDIR}/tmp&quot;
</span>
<span class="comment">#
# Default policy config
#
# The distribution setting controls which policy settings are used as defaults.
# The default value is fine for general Yocto project use, at least initially.
# Ultimately when creating custom policy, people will likely end up subclassing
# these defaults.
#
</span>DISTRO ?<span class="operator">=</span> <span class="literal string double">&quot;poky&quot;</span>
<span class="comment"># As an example of a subclass there is a &quot;bleeding&quot; edge policy configuration
# where many versions are set to the absolute latest code from the upstream
# source control systems. This is just mentioned here as an example, its not
# useful to most new users.
# DISTRO ?= &quot;poky-bleeding&quot;
</span>
<span class="comment">#
# Package Management configuration
#
# This variable lists which packaging formats to enable. Multiple package backends
# can be enabled at once and the first item listed in the variable will be used
# to generate the root filesystems.
# Options are:
#  - 'package_deb' for debian style deb files
#  - 'package_ipk' for ipk files are used by opkg (a debian style embedded package manager)
#  - 'package_rpm' for rpm style packages
# E.g.: PACKAGE_CLASSES ?= &quot;package_rpm package_deb package_ipk&quot;
# We default to rpm:
</span>PACKAGE_CLASSES ?<span class="operator">=</span> <span class="literal string double">&quot;package_rpm&quot;</span>

<span class="comment">#
# SDK/ADT target architecture
#
# This variable specifies the architecture to build SDK/ADT items for and means
# you can build the SDK packages for architectures other than the machine you are
# running the build on (i.e. building i686 packages on an x86_64 host).
# Supported values are i686 and x86_64
#SDKMACHINE ?= &quot;i686&quot;
</span>
<span class="comment">#
# Extra image configuration defaults
#
# The EXTRA_IMAGE_FEATURES variable allows extra packages to be added to the generated
# images. Some of these options are added to certain image types automatically. The
# variable can contain the following options:
#  &quot;dbg-pkgs&quot;       - add -dbg packages for all installed packages
#                     (adds symbol information for debugging/profiling)
#  &quot;dev-pkgs&quot;       - add -dev packages for all installed packages
#                     (useful if you want to develop against libs in the image)
#  &quot;ptest-pkgs&quot;     - add -ptest packages for all ptest-enabled packages
#                     (useful if you want to run the package test suites)
#  &quot;tools-sdk&quot;      - add development tools (gcc, make, pkgconfig etc.)
#  &quot;tools-debug&quot;    - add debugging tools (gdb, strace)
#  &quot;eclipse-debug&quot;  - add Eclipse remote debugging support
#  &quot;tools-profile&quot;  - add profiling tools (oprofile, exmap, lttng, valgrind)
#  &quot;tools-testapps&quot; - add useful testing tools (ts_print, aplay, arecord etc.)
#  &quot;debug-tweaks&quot;   - make an image suitable for development
#                     e.g. ssh root access has a blank password
# There are other application targets that can be used here too, see
# meta/classes/image.bbclass and meta/classes/core-image.bbclass for more details.
# We default to enabling the debugging tweaks.
</span>
<span class="comment"># [2.] tools-sdk &amp; tools-debug added
</span><span class="name variable">EXTRA_IMAGE_FEATURES</span> <span class="operator">=</span> <span class="literal string double">&quot;debug-tweaks tools-sdk tools-debug&quot;</span>

<span class="comment">#
# Additional image features
#
# The following is a list of additional classes to use when building images which
# enable extra features. Some available options which can be included in this variable
# are:
#   - 'buildstats' collect build statistics
#   - 'image-mklibs' to reduce shared library files size for an image
#   - 'image-prelink' in order to prelink the filesystem image
#   - 'image-swab' to perform host system intrusion detection
# NOTE: if listing mklibs &amp; prelink both, then make sure mklibs is before prelink
# NOTE: mklibs also needs to be explicitly enabled for a given image, see local.conf.extended
</span>USER_CLASSES ?<span class="operator">=</span> <span class="literal string double">&quot;buildstats image-mklibs image-prelink&quot;</span>

<span class="comment">#
# Runtime testing of images
#
# The build system can test booting virtual machine images under qemu (an emulator)
# after any root filesystems are created and run tests against those images. To
# enable this uncomment this line. See classes/testimage(-auto).bbclass for
# further details.
#TEST_IMAGE = &quot;1&quot;
#
# Interactive shell configuration
#
# Under certain circumstances the system may need input from you and to do this it
# can launch an interactive shell. It needs to do this since the build is
# multithreaded and needs to be able to handle the case where more than one parallel
# process may require the user's attention. The default is iterate over the available
# terminal types to find one that works.
#
# be applied, to use the devshell or the kernel menuconfig
#
# Supported values are auto, gnome, xfce, rxvt, screen, konsole (KDE 3.x only), none
# Note: currently, Konsole support only works for KDE 3.x due to the way
# newer Konsole versions behave
#OE_TERMINAL = &quot;auto&quot;
# By default disable interactive patch resolution (tasks will just fail instead):
</span><span class="name variable">PATCHRESOLVE</span> <span class="operator">=</span> <span class="literal string double">&quot;noop&quot;</span>

<span class="comment">#
# Disk Space Monitoring during the build
#
# Monitor the disk space during the build. If there is less that 1GB of space or less
# than 100K inodes in any key build location (TMPDIR, DL_DIR, SSTATE_DIR), gracefully
# shutdown the build. If there is less that 100MB or 1K inodes, perform a hard abort
# of the build. The reason for this is that running completely out of space can corrupt
# files and damages the build in ways which may not be easily recoverable.
</span><span class="name variable">BB_DISKMON_DIRS</span> <span class="operator">=</span> <span class="literal string double">&quot;\
    STOPTASKS,${TMPDIR},1G,100K \
    STOPTASKS,${DL_DIR},1G,100K \
    STOPTASKS,${SSTATE_DIR},1G,100K \
    ABORT,${TMPDIR},100M,1K \
    ABORT,${DL_DIR},100M,1K \
    ABORT,${SSTATE_DIR},100M,1K&quot;</span>

<span class="comment">#
# Shared-state files from other locations
#
# As mentioned above, shared state files are prebuilt cache data objects which can
# used to accelerate build time. This variable can be used to configure the system
# to search other mirror locations for these objects before it builds the data itself.
#
# This can be a filesystem directory, or a remote url such as http or ftp. These
# would contain the sstate-cache results from previous builds (possibly from other
# machines). This variable works like fetcher MIRRORS/PREMIRRORS and points to the
# cache locations to check for the shared objects.
# NOTE: if the mirror uses the same structure as SSTATE_DIR, you need to add PATH
# at the end as shown in the examples below. This will be substituted with the
# correct path within the directory structure.
#SSTATE_MIRRORS ?= &quot;\
#file://.* http://someserver.tld/share/sstate/PATH;downloadfilename=PATH \n \
#file://.* file:///some/local/dir/sstate/PATH&quot;
</span>

<span class="comment">#
# Qemu configuration
#
# By default qemu will build with a builtin VNC server where graphical output can be
# seen. The two lines below enable the SDL backend too. This assumes there is a
# libsdl library available on your build system.
</span>PACKAGECONFIG_append_pn-qemu-native <span class="operator">=</span> <span class="literal string double">&quot; sdl&quot;</span>
PACKAGECONFIG_append_pn-nativesdk-qemu <span class="operator">=</span> <span class="literal string double">&quot; sdl&quot;</span>
ASSUME_PROVIDED +<span class="operator">=</span> <span class="literal string double">&quot;libsdl-native&quot;</span>


<span class="comment"># CONF_VERSION is increased each time build/conf/ changes incompatibly and is used to
# track the version of this file when it was generated. This can safely be ignored if
# this doesn't mean anything to you.
</span><span class="name variable">CONF_VERSION</span> <span class="operator">=</span> <span class="literal string double">&quot;1&quot;</span>

<span class="comment"># [3.] slim ssh-client dropbear added
</span>CORE_IMAGE_EXTRA_INSTALL +<span class="operator">=</span> <span class="literal string double">&quot;dropbear&quot;</span>
<span class="comment"># [4.] git-vcn added
</span>CORE_IMAGE_EXTRA_INSTALL +<span class="operator">=</span> <span class="literal string double">&quot;git&quot;</span>
<span class="comment"># [5.] slim htpd-server added
</span>CORE_IMAGE_EXTRA_INSTALL +<span class="operator">=</span> <span class="literal string double">&quot;lighttpd&quot;</span>
<span class="comment"># [6.] wireless-tools and functions for the hot-spot functionality
</span>CORE_IMAGE_EXTRA_INSTALL +<span class="operator">=</span> <span class="literal string double">&quot;wireless-tools&quot;</span>
</pre>
</div>
<div class="section" id="bitbake-eine-build-umgebung-fur-ein-angepasstes-yocto-linux">
<h3><a class="toc-backref" href="#id18">2.2.3&nbsp;&nbsp;&nbsp;Bitbake eine Build-umgebung für ein angepasstes Yocto-linux</a></h3>
<p>Im nächsten Schritt kann nun mit dem Bau des Yocto Images begonnen werden dies kann je nach Host-Rechner bis zu mehreren Stunden dauern, deswegen sollte man hier entsprechend viel Zeit einplanen. Außerdem sollte bedacht werden das dieser Vorgang einen Großteil der Zeit annähernd alle Ressourcen auf dem Entwicklungsrechner beansprucht.</p>
<pre class="code bash literal-block">
<span class="comment"># eine Linuxumgebung, die neben den vorgeingestellten Komponenten die wichtigsten Grundfunktionen enthält
# die von uns gewählte Konfiguration
</span>bitbake core-image-base

<span class="comment"># weitere wichtige Basiskonfigurationen:
</span>
<span class="comment"># minimale Linuxumgebung
</span>bitbake core-image-minimal

<span class="comment"># real-time unterstützte Linuxumgebung
</span>bitbake core-image-rt
</pre>
<div class="figure align-center">
<img alt="img/Yocto-build1.png" src="img/Yocto-build1.png" />
</div>
</div>
<div class="section" id="hob-und-toaster-graphische-oberflachen-fur-die-konfiguration-von-yocto">
<h3><a class="toc-backref" href="#id19">2.2.4&nbsp;&nbsp;&nbsp;hob und toaster - graphische Oberflächen für die Konfiguration von Yocto</a></h3>
</div>
</div>
</div>
<div class="section" id="vorbereiten-der-microsd-karte">
<h1><a class="toc-backref" href="#id20">3&nbsp;&nbsp;&nbsp;Vorbereiten der microSD Karte</a></h1>
<pre class="code bash literal-block">
sudo fdisk -lu &lt;dev/device_name&gt;
<span class="comment"># for my system
</span>sudo fdisk -lu dev/mmcblk0
</pre>
<div class="figure align-center">
<img alt="img/fdisk-list-volumes.png" src="img/fdisk-list-volumes.png" />
</div>
<ul class="simple">
<li>Die aktuelle Partitionierung der microSD Karte löschen</li>
</ul>
<pre class="code bash literal-block">
Befehl <span class="operator">(</span>m für Hilfe<span class="operator">)</span>: d
Selected partition 1
Partition 1 has been deleted.
</pre>
<ul class="simple">
<li>Anlegen der zwei neuen Partitionen boot (min. 100 MB) und root (rest)</li>
</ul>
<pre class="code bash literal-block">
Befehl <span class="operator">(</span>m für Hilfe<span class="operator">)</span>: n
Partition <span class="name builtin">type
   </span>p   primary <span class="operator">(</span>0 primary, 0 extended, 4 free<span class="operator">)</span>
   e   extended <span class="operator">(</span>container <span class="keyword">for </span>logical partitions<span class="operator">)</span>
Select <span class="operator">(</span>default p<span class="operator">)</span>: p
Partitionsnummer <span class="operator">(</span>1-4, default 1<span class="operator">)</span>: 1
First sector <span class="operator">(</span>2048-30881791, default 2048<span class="operator">)</span>:
Last sector, +sectors or +size<span class="operator">{</span>K,M,G,T,P<span class="operator">}</span> <span class="operator">(</span>2048-30881791, default 30881791<span class="operator">)</span>: +100M

Created a new partition 1 of <span class="name builtin">type</span> <span class="literal string single">'Linux'</span> and of size 100 MiB.


Befehl <span class="operator">(</span>m für Hilfe<span class="operator">)</span>: n
Partition <span class="name builtin">type
   </span>p   primary <span class="operator">(</span>1 primary, 0 extended, 3 free<span class="operator">)</span>
   e   extended <span class="operator">(</span>container <span class="keyword">for </span>logical partitions<span class="operator">)</span>
Select <span class="operator">(</span>default p<span class="operator">)</span>: p
Partitionsnummer <span class="operator">(</span>2-4, default 2<span class="operator">)</span>: 2
First sector <span class="operator">(</span>206848-30881791, default 206848<span class="operator">)</span>: <span class="operator">[</span>ENTER<span class="operator">]</span>
Last sector, +sectors or +size<span class="operator">{</span>K,M,G,T,P<span class="operator">}</span> <span class="operator">(</span>206848-30881791, default 30881791<span class="operator">)</span>: <span class="operator">[</span>ENTER<span class="operator">]</span>

Created a new partition 2 of <span class="name builtin">type</span> <span class="literal string single">'Linux'</span> and of size 14,6 GiB.
</pre>
<ul class="simple">
<li>setzen des bootable flags auf der boot Partition</li>
</ul>
<pre class="code bash literal-block">
Befehl <span class="operator">(</span>m für Hilfe<span class="operator">)</span>: a
Partitionsnummer <span class="operator">(</span>1,2, default 2<span class="operator">)</span>: 1

The bootable flag on partition 1 is enabled now.
</pre>
<div class="section" id="boot-formatieren-als-fat16-lba">
<h2><a class="toc-backref" href="#id21">3.1&nbsp;&nbsp;&nbsp;boot formatieren als FAT16 (LBA)</a></h2>
<pre class="code bash literal-block">
Befehl <span class="operator">(</span>m für Hilfe<span class="operator">)</span>: t
Partitionsnummer <span class="operator">(</span>1,2, default 2<span class="operator">)</span>: 1
Hex code <span class="operator">(</span><span class="name builtin">type </span>L to list all codes<span class="operator">)</span>: e

If you have created or modified any DOS 6.x partitions, please see the fdisk documentation <span class="keyword">for </span>additional information.
Changed <span class="name builtin">type </span>of partition <span class="literal string single">'Linux'</span> to <span class="literal string single">'W95 FAT16 (LBA)'</span>.
</pre>
</div>
<div class="section" id="root-als-linux-formatieren">
<h2><a class="toc-backref" href="#id22">3.2&nbsp;&nbsp;&nbsp;root als &quot;Linux&quot; formatieren</a></h2>
<pre class="code bash literal-block">
Befehl <span class="operator">(</span>m für Hilfe<span class="operator">)</span>: t
Partitionsnummer <span class="operator">(</span>1,2, default 2<span class="operator">)</span>: 2
Hex code <span class="operator">(</span><span class="name builtin">type </span>L to list all codes<span class="operator">)</span>: 83

Changed <span class="name builtin">type </span>of partition <span class="literal string single">'Linux'</span> to <span class="literal string single">'Linux'</span>.
</pre>
<ul class="simple">
<li>Überprüfung der SD Karte im Normalfall sollte es etwar so aussehen</li>
</ul>
<pre class="code bash literal-block">
Befehl <span class="operator">(</span>m für Hilfe<span class="operator">)</span>: p
Disk /dev/mmcblk0: 14,7 GiB, 15811477504 bytes, 30881792 sectors
Geometry: 255 heads, 63 sectors/track, 482528 cylinders
Units: sectors of 1 * <span class="name variable">512</span> <span class="operator">=</span> 512 bytes
Sector size <span class="operator">(</span>logical/physical<span class="operator">)</span>: 512 bytes / 512 bytes
I/O size <span class="operator">(</span>minimum/optimal<span class="operator">)</span>: 512 bytes / 512 bytes
Disklabel <span class="name builtin">type</span>: dos
Disk identifier: 0x00000000

Device         Boot  Start      End  Sectors  Size Id Type
/dev/mmcblk0p1 *      2048   206847   204800  100M  c W95 FAT32 <span class="operator">(</span>LBA<span class="operator">)</span>
/dev/mmcblk0p2      206848 30881791 30674944 14,6G 83 Linux
</pre>
</div>
<div class="section" id="die-anderungen-auf-der-sd-karte-anwenden">
<h2><a class="toc-backref" href="#id23">3.3&nbsp;&nbsp;&nbsp;Die Änderungen auf der SD Karte anwenden</a></h2>
<pre class="code bash literal-block">
Befehl <span class="operator">(</span>m für Hilfe<span class="operator">)</span>: w
The partition table has been altered.
Calling ioctl<span class="operator">()</span> to re-read partition table.
Re-reading the partition table failed.: Das Gerät oder die Ressource ist belegt

The kernel still uses the old table. The new table will be used at the next reboot or after you run partprobe<span class="operator">(</span>8<span class="operator">)</span> or kpartx<span class="operator">(</span>8<span class="operator">)</span>.
</pre>
<pre class="code bash literal-block">
lsblk
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sda           8:0    0 465,8G  0 disk
├─sda1        8:1    0   100M  0 part
├─sda2        8:2    0 140,5G  0 part
├─sda3        8:3    0   100G  0 part
├─sda4        8:4    0     1K  0 part
├─sda5        8:5    0 221,6G  0 part /
└─sda6        8:6    0   3,6G  0 part <span class="operator">[</span>SWAP<span class="operator">]</span>
mmcblk0     179:0    0  14,7G  0 disk
├─mmcblk0p1 179:1    0   100M  0 part
└─mmcblk0p2 179:2    0  14,6G  0 part
</pre>
</div>
<div class="section" id="anlegen-des-filesystem-und-der-partitionstabelle">
<h2><a class="toc-backref" href="#id24">3.4&nbsp;&nbsp;&nbsp;Anlegen des Filesystem und der Partitionstabelle</a></h2>
<div class="section" id="boot-partition">
<h3><a class="toc-backref" href="#id25">3.4.1&nbsp;&nbsp;&nbsp;&quot;boot-Partition&quot;</a></h3>
<p>Für die boot-Partition benötigt man das FAT16 Format, außerdem muss das sogenannte &quot;bootable&quot; flag gesetzt werden.</p>
<pre class="code bash literal-block">
sudo mkfs.vfat -F 16 -n <span class="literal string double">&quot;boot&quot;</span> /dev/mmcblk0p1
</pre>
</div>
<div class="section" id="root-partition">
<h3><a class="toc-backref" href="#id26">3.4.2&nbsp;&nbsp;&nbsp;&quot;root-Partition&quot;</a></h3>
<p>Die root-Partition benötigt ein Linux kompatibles Filesystem in diesem Beispiel verwenden wir ext3.</p>
<pre class="code bash literal-block">
sudo mke2fs -j -L <span class="literal string double">&quot;root&quot;</span> /dev/mmcblk0p2

Ein Dateisystems mit 3833856 <span class="operator">(</span>4k<span class="operator">)</span> Blöcken und 960336 Inodes wird erzeugt.
UUID des Dateisystems: f013f938-dc87-4a3a-a1c4-9961d1d88215
Superblock-Sicherungskopien gespeichert in den Blöcken:
        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208

beim Anfordern von Speicher für die Gruppentabellen: erledigt
Inode-Tabellen werden geschrieben: erledigt
Das Journal <span class="operator">(</span>32768 Blöcke<span class="operator">)</span> wird angelegt: erledgt
Die Superblöcke und die Informationen über die Dateisystemnutzung werden geschrieben: erledigt
</pre>
</div>
</div>
</div>
<div class="section" id="platzieren-der-daten-auf-der-sd-karte">
<h1><a class="toc-backref" href="#id27">4&nbsp;&nbsp;&nbsp;Platzieren der Daten auf der SD-Karte</a></h1>
<div class="section" id="instalation-des-bootloaders">
<h2><a class="toc-backref" href="#id28">4.1&nbsp;&nbsp;&nbsp;Instalation des Bootloaders</a></h2>
<pre class="code bash literal-block">
cp MLO /media/&lt;USER&gt;/boot1/MLO
cp u-boot.img /media/&lt;USER&gt;/boot1/u-boot.img
</pre>
</div>
<div class="section" id="kopieren-und-entpacken-des-filesystems">
<h2><a class="toc-backref" href="#id29">4.2&nbsp;&nbsp;&nbsp;Kopieren und Entpacken des Filesystems</a></h2>
<pre class="code bash literal-block">
<span class="comment"># Dateisystem direkt auf der SD-Karte entpacken (von manchen systemen nicht unterstützt)
</span>sudo tar -xvpf core-image-&lt;something...&gt;.tar.bz2 -C /media/&lt;USER&gt;/root/

<span class="comment"># Sollte das nicht möglich sein kann man das Archiv alternativ auf die SD-Karte kopieren und dort entpacken
</span>sudo cp core-image-&lt;something...&gt;.rootfs.tar.bz2 /media/&lt;USER&gt;/root/
<span class="comment"># die root-Partition der SD-Karte in einem terminal öffnen und dort entpacken
</span>sudo tar -xf core-image-&lt;something...&gt;.rootfs.tar.bz2
<span class="comment"># falls nötig Zusätzliche Module installieren
</span>sudo tar x -C /media/&lt;USER&gt;/root/ -f modules-beaglebone.tgz
</pre>
<pre class="code bash literal-block">
<span class="comment"># da in unseren Versuchen die Ergebnisse nicht einheitlich waren sollte noch angemerkt werden,
# dass auf der &quot;root-Partition&quot; im Verzeichnis &quot;/boot&quot; die folgenden Dateien vorhanden sein sollten:
# boot/
# ├─am335-bone.dtb
# ├─am335-boneblack.dtb
# ├─beaglebone.bin
# └─uImage
# falls nicht sollten diese manuel in das Verzeichnis kopiert werden.
</span>
sudo cp uImage-am335x-bone.dtb /media/&lt;USER&gt;/root/boot/am335x-bone.dtb
sudo cp uImage-am335x-boneblack.dtb /media/&lt;USER&gt;/root/boot/am335x-boneblack.dtb
sudo cp uImage-beaglebone.bin /media/&lt;USER&gt;/root/boot/beaglebone.bin
sudo cp uImage /media/&lt;USER&gt;/root/boot/uImage
</pre>
</div>
</div>
<div class="section" id="das-u-boot">
<h1><a class="toc-backref" href="#id30">5&nbsp;&nbsp;&nbsp;Das u-boot</a></h1>
<div class="section" id="einstellungen-von-u-boot-uberprufen">
<h2><a class="toc-backref" href="#id31">5.1&nbsp;&nbsp;&nbsp;Einstellungen von u-boot überprüfen</a></h2>
<pre class="code bash literal-block">
strings u-boot.img | grep loaduimage
<span class="comment"># wichtige Ausgabe:
</span><span class="name variable">loaduimage</span><span class="operator">=</span>load mmc <span class="keyword">${</span><span class="name variable">bootpart</span><span class="keyword">}</span> <span class="keyword">${</span><span class="name variable">loadaddr</span><span class="keyword">}</span> <span class="keyword">${</span><span class="name variable">bootdir</span><span class="keyword">}</span>/<span class="keyword">${</span><span class="name variable">bootfile</span><span class="keyword">}</span>
</pre>
<pre class="code bash literal-block">
strings u-boot.img | grep bootpart
<span class="comment"># wichtige Ausgabe:
</span><span class="name variable">bootpart</span><span class="operator">=</span>0:2
<span class="name variable">loadfdt</span><span class="operator">=</span>load mmc <span class="keyword">${</span><span class="name variable">bootpart</span><span class="keyword">}</span> <span class="keyword">${</span><span class="name variable">fdtaddr</span><span class="keyword">}</span> <span class="keyword">${</span><span class="name variable">bootdir</span><span class="keyword">}</span>/<span class="keyword">${</span><span class="name variable">fdtfile</span><span class="keyword">}</span>
</pre>
<pre class="code bash literal-block">
strings u-boot.img | grep bootdir
<span class="comment"># wichtige Ausgabe:
</span><span class="name variable">bootdir</span><span class="operator">=</span>/boot
</pre>
<pre class="code bash literal-block">
strings u-boot.img | grep bootfile
<span class="comment"># wichtige Ausgabe
</span><span class="name variable">bootfile</span><span class="operator">=</span>uImage
</pre>
</div>
<div class="section" id="zugriff-auf-das-serielle-terminal-wahrend-des-bootvorganges">
<h2><a class="toc-backref" href="#id32">5.2&nbsp;&nbsp;&nbsp;Zugriff auf das serielle Terminal während des Bootvorganges</a></h2>
<p>Nachdem das Beaglebone Black mit dem USB-to-ttl mit dem Entwicklungsrechner verbunden wurde müssen noch einige Einstellungen getätigt werden um das arbeiten mit einem &quot;Serial-Terminal-Emulator&quot; möglich zu machen.</p>
<div class="figure align-center">
<img alt="img/Connect-BBB-SerialTerminal.png" src="img/Connect-BBB-SerialTerminal.png" />
</div>
<p>Unter anderem muss die richtige Schnittstelle, auf die die Verbindung zum BBB im Moment abgebildet wird gefunden werden.</p>
<pre class="code bash literal-block">
dmesg | grep serial

<span class="comment"># Normalerweise sollte es auf ttyUSB0 abgebildet werden deshalb lässt sich auch folgender Befehl anwenden:
</span>dmesg | grep ttyUSB0
<span class="operator">[</span> 1080.035495<span class="operator">]</span> usb 3-1.2: FTDI USB Serial Device converter now attached to ttyUSB0
</pre>
<div class="figure align-center">
<img alt="img/BBB-dmesg.png" src="img/BBB-dmesg.png" />
</div>
<p>Um während des Bootvorganges auf das Serielle Terminal und somit auch auf den Bootloader u-boot zugreifen zu können benötigt man einen serielles Terminal (bzw. einen Emulator) wie z.B. Minicom außerdem werden spezielle Befugnisse für das Zugreifen auf den Port benötigt hierfür gibt es 2 unterschiedliche herangehensweisen:</p>
<ol class="loweralpha simple">
<li>Ändern der Befugnisse um auf den seriellen Port zugreifen zu dürfen</li>
</ol>
<pre class="code bash literal-block">
sudo chmod 0666 dev/tty&lt;Device&gt;
<span class="comment"># for my system
</span>sudo chmod 0666 dev/ttyUSB0
</pre>
<ol class="loweralpha simple" start="2">
<li>Eigenes Profil zur Gruppe &quot;dialout&quot; hinzufügen um auf den seriellen Port zugreifen zu dürfen</li>
</ol>
<pre class="code bash literal-block">
sudo usermod -a -G dialout &lt;username&gt;
</pre>
<p>Außerdem muss der Terminal Emulator der Wahl noch angepasst werden, bzw. mit den entsprechenden Variablen, wie dem Pfad, der Baudrate, Parity und der Konfiguration an Datenbits und Stopbits aufgerufen werden. Die Vorgehensweise für &quot;minicom&quot; wird im Abschnitt &quot;Tools und Programme&quot; genauer beschrieben.</p>
<table border="1" class="docutils">
<colgroup>
<col width="61%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">&nbsp;</th>
<th class="head">Konfiguration für BBB</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>Baudrate</td>
<td>115200</td>
</tr>
<tr><td>Anzahl der Daten-Bits</td>
<td>8 Databits</td>
</tr>
<tr><td>Parity</td>
<td>no Parity</td>
</tr>
<tr><td>Stopbits</td>
<td>1 Stopbit</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="netboot-test">
<h1><a class="toc-backref" href="#id33">6&nbsp;&nbsp;&nbsp;Netboot test</a></h1>
<p>Im Netboot Teil wurde mangels eines USB auf TTL Adapters kurzerhand zum Raspberry Pi 2 gewechselt. Netzwerkboot bietet sich vor allem an, wenn entweder mit besonders großen Dateinen gearbeitet werden soll oder ein kontinuierlicher geringer Datenstrom verarbeitet werden soll. permanente kleine schreibende Zugriffe (v.A. wenn ein Datensatz erheblich kleiner ist als ein Block des SD-Speichers) vermindern die Lebensdauer einer SD-Karte erheblich. Um diese Probleme zu umgehen bedient man sich eines FTP-Servers (häufig findet man diese auch in modernen Routern und Accesspoints).</p>
</div>
<div class="section" id="debian-8-0-fur-das-beaglebone-black">
<h1><a class="toc-backref" href="#id34">7&nbsp;&nbsp;&nbsp;Debian 8.0 für das BeagleBone Black</a></h1>
<p>Da sich das arbeiten und entwickeln unter der selbst gebauten Yocto-distribution als zunehmend schwierig herausgestellt hat und wir bereits Erfahrungen mit dem Selbst bauen und kompilieren von Images für unser BBB gesammelt haben wurde beschlossen für die Fertigstellung unseres Projektes auf ein Debian zu wechseln. Vor allem um auf den Komfort eines Paketmanagers zurückgreifen zu können.</p>
<pre class="code bash literal-block">
<span class="comment"># einfach ein passendes SD-Karten abbild finden und herunterladen
# Achtung für das BBB gibt es sowohl flasher images für den eMMC als auch SD-Karten images
</span>wget https://rcn-ee.com/rootfs/2015-05-08/microsd/bone-debian-8.0-console-armhf-2015-05-08-2gb.img.xz

<span class="comment"># image entpacken
</span>unxz bone-debian-8.0-console-armhf-2015-05-08-2gb.img.xz

<span class="comment"># image auf die SD-Karten kopieren
</span>sudo dd <span class="keyword">if</span><span class="operator">=</span>./bone-debian-8.0-console-armhf-2015-05-08-2gb.img <span class="name variable">of</span><span class="operator">=</span>/dev/sdX
</pre>
<div class="section" id="die-ersten-schritte-nach-dem-erfolgreichen-platzieren-des-images">
<h2><a class="toc-backref" href="#id35">7.1&nbsp;&nbsp;&nbsp;Die ersten Schritte nach dem erfolgreichen platzieren des images:</a></h2>
<pre class="code bash literal-block">
<span class="comment"># aufgrund der Voreinstellungen im image ist es wieder möglich über die mini-USB Schnittstelle per ssh mit dem Board zu verbinden
</span>ssh debian&#64;192.168.7.2
passwd: temppwd

<span class="comment"># oder
</span>ssh debian&#64;arm
passwd: temppwd

<span class="comment"># image der größe der SD-Karten anpassen
</span>sudo sh /opt/scripts/tools/growpartition.sh

<span class="comment"># danach sollte das Betriebssystem neu gestartet werden um die durchgeführten Änderungen abzuschließen
</span>sudo reboot

<span class="comment"># richtige Zeitzone angeben
</span><span class="name builtin">echo</span> <span class="literal string double">&quot;Europe/Berlin&quot;</span> &gt; /etc/timezone
dpkg-reconfigure -f noninteractive tzdata

<span class="comment"># Installieren von &quot;build-essentials&quot;
</span>sudo apt-get install build-essentials

<span class="comment"># Installieren von &quot;lighttpd&quot;
</span>sudo apt-get install lighttpd

<span class="comment"># Installation von &quot;hostapd&quot;
</span>sudo apt-get install hostapd

<span class="comment"># Installation von &quot;dnsmasq&quot;
</span>sudo apt-get install dnsmasq

<span class="comment"># Installation von &quot;isc-dhcp-server&quot;
</span>sudo apt-get install isc-dhcp-server
</pre>
</div>
</div>
<div class="section" id="einrichten-eines-accesspoint-auf-dem-beaglebone-black">
<h1><a class="toc-backref" href="#id36">8&nbsp;&nbsp;&nbsp;Einrichten eines Accesspoint auf dem BeagleBone Black</a></h1>
<p>Um eine Accesspoint Funktion zu ermöglichen benötigt ein Rechner oder ein Embedded System neben einem W-Lan Adapter einen dhcp-server, einen http-server, wie zum Beispiel (Apache - im Desktop Bereich oder lighttpd - im ES-Bereich) und einen DNS-Server. Außerdem müssen diverse Einstellungen entsprechend der geplanten Verwendungsweise getroffen werden. Im folgenden wird dieser Vorgang behandelt.</p>
<p>Um die Anleitung möglichst allgemein zu halten werden in der folgenden Erklärung die eigentlichen Werte durch die Lables in der Tabelle ersetzt die von uns verwendeten Konfigurationen wurden in den Dateien unter &quot;../config-files/&quot; abgelegt.</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="20%" />
<col width="22%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">Name</th>
<th class="head">Lable</th>
<th class="head">Value in unserer Konfiguration</th>
<th class="head">Funktion</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>ssid</td>
<td>&lt;Your-SSID&gt;</td>
<td>GeoSpotAp</td>
<td>der Name des lokalen W-Lan Netzwerkes</td>
</tr>
<tr><td>wpa_passphrase</td>
<td>&lt;Your-Passphrase&gt;</td>
<td>geospotap</td>
<td>das Passwort für den Zugang zum W-Lan</td>
</tr>
<tr><td>interface</td>
<td>&lt;YOUR-WIFI-INTERFACE&gt;</td>
<td>wlan0</td>
<td>der Name des W-Lan Interfaces (gewöhnlich wlan0)</td>
</tr>
<tr><td>bridge</td>
<td>&lt;YOUR-BRIDGE-NAME&gt;</td>
<td>&nbsp;</td>
<td>Name der lokalen bridge (gewöhnlich br0)</td>
</tr>
<tr><td>driver</td>
<td>&lt;GENERIC-DRIVER-IF&gt;</td>
<td>&nbsp;</td>
<td>Treiber Interface für &quot;hostapd&quot;</td>
</tr>
<tr><td>channel</td>
<td>&lt;YOUR-WIFI-CHANNEL&gt;</td>
<td>09</td>
<td>der Kanal des W-Lan Netzes (auf lokale Gegebenheiten reagieren!)</td>
</tr>
<tr><td>country_code</td>
<td>&lt;YOUR-COUNTRY-CODE&gt;</td>
<td>Ländercode (GER = Deutschland)</td>
<td>&nbsp;</td>
</tr>
<tr><td>subnet</td>
<td>&lt;YOUR-SUBNET&gt;
&lt;x&gt;.&lt;y&gt;.&lt;z&gt;.0</td>
<td>192.168.4.0</td>
<td>&nbsp;</td>
</tr>
<tr><td rowspan="2">range</td>
<td>&lt;FIRST-FREE-IP&gt;</td>
<td>192.168.4.4</td>
<td rowspan="2">&nbsp;</td>
</tr>
<tr><td>&lt;LAST-FREE-IP&gt;</td>
<td>192.168.4.64</td>
</tr>
<tr><td>adress</td>
<td>&lt;x&gt;.&lt;y&gt;.&lt;z&gt;.&lt;BASE-ADRESS&gt;</td>
<td>192.168.4.1</td>
<td>Basis Adresse des w-lan Moduls</td>
</tr>
<tr><td>netmask</td>
<td>&lt;YOUR-NETMASK&gt;</td>
<td>191 (= 255 - 64)</td>
<td>Zum ausmaskieren von Werten z.B. 255.255.255.&lt;#-of-free-ips&gt;
oder 255.255.255.0</td>
</tr>
<tr><td>Router</td>
<td>&lt;YOUR-ROUTER&gt;</td>
<td>192.168.2.1</td>
<td>die IP-Adresse des lokalen Routers</td>
</tr>
</tbody>
</table>
<div class="section" id="einrichten-des-w-lan-interfaces">
<h2><a class="toc-backref" href="#id37">8.1&nbsp;&nbsp;&nbsp;Einrichten des W-Lan Interfaces</a></h2>
<pre class="code bash literal-block">
<span class="comment"># modifizieren der Netzwerk Interfaces
</span>vi /etc/network/interfaces

<span class="comment"># folgende Zeilen sind nur ein beispiel, aber ähnliches sollte hinzugefügt werden:
</span>auto wlan0
        iface &lt;YOUR-WIFI-INTERFACE&gt; inet dhcp
address   &lt;YOUR-SUBNET&gt;.1
network   &lt;YOUR-SUBNET&gt;.0
netmask   &lt;YOUR-NETMASK&gt;
broadcast &lt;YOUR-SUBNET&gt;.&lt;LAST-FREE-IP&gt;

<span class="comment"># den Netzwerk Service reseten
</span>/etc/init.d/networking restart

<span class="comment"># das wifi device starten
</span>rfkill unblock &lt;DEVICE&gt;
<span class="comment"># in unserem Beispiel
</span>rfkilll unblock wlan0
<span class="comment"># oder
</span>iwconfig &lt;YOUR-WIFI-INTERFACE&gt; txpower on

<span class="comment"># ruft man nun ifconfig auf sollte das Interface wlan0 sichtbar sein
</span>usb0    Link encap:Ethernet  HWaddr ce:24:9f:01:71:88
    inet addr:192.168.7.2  Bcast:192.168.7.3  Mask:255.255.255.252
    inet6 addr: fe80::cc24:9fff:fe01:7188/64 Scope:Link
    UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
    RX packets:1075 errors:0 dropped:0 overruns:0 frame:0
    TX packets:725 errors:0 dropped:0 overruns:0 carrier:0
    collisions:0 txqueuelen:1000
    RX bytes:87654 <span class="operator">(</span>85.5 KiB<span class="operator">)</span>  TX bytes:86496 <span class="operator">(</span>84.4 KiB<span class="operator">)</span>

wlan0   Link encap:Ethernet  HWaddr e0:46:9a:0d:61:a3
        UP BROADCAST MULTICAST  MTU:1500  Metric:1
        RX packets:0 errors:0 dropped:0 overruns:0 frame:0
        TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
        collisions:0 txqueuelen:1000
        RX bytes:0 <span class="operator">(</span>0.0 B<span class="operator">)</span>  TX bytes:0 <span class="operator">(</span>0.0 B<span class="operator">)</span>
</pre>
</div>
<div class="section" id="konfiguration-des-hostapd">
<h2><a class="toc-backref" href="#id38">8.2&nbsp;&nbsp;&nbsp;Konfiguration des hostapd</a></h2>
<pre class="code bash literal-block">
vi /etc/default/hostapd
<span class="comment"># setzen der option
</span><span class="name variable">DAEMON_CONF</span><span class="operator">=</span><span class="literal string double">&quot;/etc/hostapd/hostapd.conf&quot;</span>

<span class="comment"># erstellen der &quot;hostapd.conf&quot; Datei
</span>touch /etc/hostapd/hostapd.conf

<span class="comment"># anpassen der &quot;hostapd.conf&quot; Datei
</span>vi /etc/hostapd/hostapd.conf
</pre>
<p>In der Datei &quot;hostapd.conf&quot; werden die Standard Parameter für den Wifi-Accesspoint gesetzt. Diese werden bei jedem Startvorgang geladen. In der folgenden Beispiel Datei wurden die Parameter, die unbedingt ersetzt werden müssen durch gekennzeichnete Lables ersetzt. Eine kurze Erklärung der Lables folgt.</p>
<pre class="code bash literal-block">
<span class="comment">### wireless network configuration ###
### interface ###
</span><span class="name variable">interface</span><span class="operator">=</span>&lt;YOUR-WIFI-INTERFACE&gt;
<span class="comment">### bridge name ###
#bridge=&lt;YOUR-BRIDGE-NAME&gt;
### driver ###
</span><span class="name variable">driver</span><span class="operator">=</span>&lt;YOUR-WIFI-DRIVER&gt;
<span class="comment">### Country Code ###
</span><span class="name variable">country_code</span><span class="operator">=</span>&lt;YOUR-COUNTRY-CODE&gt;
<span class="comment">### SSID ###
</span><span class="name variable">ssid</span><span class="operator">=</span>&lt;YOUR-WIFI-NAME&gt;
<span class="comment">### Channel ###
</span><span class="name variable">channel</span><span class="operator">=</span>&lt;YOUR-WIFI-CHANNEL&gt;
<span class="comment">### HW-Mode ###
</span><span class="name variable">hw_mode</span><span class="operator">=</span>g
<span class="comment">### Static WPA2 key configuration ###
# chose one of the following options
# 1=wpa1, 2=wpa2, 3=both
</span><span class="name variable">wpa</span><span class="operator">=</span>2
<span class="comment">### WPA-Passphrase ###
</span><span class="name variable">wpa_passphrase</span><span class="operator">=</span>&lt;YOUR-WIFI-PASSWORD&gt;
<span class="comment">### Key management algorithms ###
# chose one of the following options
# WEP | WPA2-PSK | WPA2-Enterprise
</span><span class="name variable">wpa_key_mgmt</span><span class="operator">=</span>WPA-PSK
<span class="comment">### Set cipher suites (encryption algorithms) ##
# TKIP = Temporal Key Integrity Protocol
# CCMP = AES in Counter mode with CBC-MAC
</span><span class="name variable">wpa_pairwise</span><span class="operator">=</span>TKIP
<span class="name variable">rsn_pairwise</span><span class="operator">=</span>CCMP
<span class="comment">### Shared Key Authentication ###
</span><span class="name variable">auth_algs</span><span class="operator">=</span>1
<span class="comment">### Accept all MAC address ###
</span><span class="name variable">macaddr_acl</span><span class="operator">=</span>0
</pre>
</div>
<div class="section" id="konfiguration-des-isc-dhcp-servers">
<h2><a class="toc-backref" href="#id39">8.3&nbsp;&nbsp;&nbsp;Konfiguration des isc-dhcp-servers</a></h2>
<p>Da das BeagleBone Black später als selbstständiger DHCP-Server fungieren soll muss ein Subnetz deklariert werden. Mit der Konfigurations-Datei bestimmt man, welche IP-Adressen der DHCP-Server vergeben kann und somit auch die maximale Anzahl der möglichen Verbindungen. Hierzu wird die Datei unter &quot;/etc/dhcp/dchpd.conf&quot; entsprechend dem folgenden Muster Ergänzt.</p>
<pre class="code bash literal-block">
subnet &lt;YOUR-SUBNET&gt;.0 netmask &lt;YOUR-NETMASK&gt; <span class="operator">{</span>
range &lt;FIRST-FREE-IP&gt; &lt;LAST-FREE-IP&gt;;
option domain-name-servers 8.8.4.4;
<span class="comment"># alternativ: option domain-name-servers 8.8.8.8;
</span>option routers &lt;YOUR-ROUTER&gt;;
interface &lt;YOUR-WIFI-INTERFACE&gt;;
<span class="operator">}</span>
</pre>
</div>
<div class="section" id="erstellen-einer-dns-maske-zur-weiterleiten-einer-bestehenden-netzwerkverbindung">
<h2><a class="toc-backref" href="#id40">8.4&nbsp;&nbsp;&nbsp;Erstellen einer DNS-Maske zur weiterleiten einer bestehenden Netzwerkverbindung</a></h2>
<p>Um die volle Funktionalität eines Wifi-Accesspoints zu ermöglichen muss eine DNS-Maske erstellt werden. Für unser Projekt war dies nicht nötig, da wir nur auf eine auf den BeagleBone Black gespecherte Webseite zugreifen müssen. Allerdings bietet es sich an hier auch noch den letzten Schritt zu beschreiben. Hierzu wird die Konfigurationsdatei unter &quot;../dnsmasq/dnsmasq.conf&quot; um die folgenden Einstellungen ergänzt.</p>
<pre class="code bash literal-block">
<span class="comment">### wifi-interface-name ###
</span><span class="name variable">interface</span><span class="operator">=</span>&lt;YOUR-WIFI-INTERFACE&gt;
<span class="comment">### dhcp-option ###
## mode, wifi-adress
# mode 3 := router
</span>dhcp-option<span class="operator">=</span>3,&lt;YOUR-SUBNET&gt;.1
<span class="comment">### dhcp-range ###
## first free adress, last free adress, netmask, time the ip is locked for
# typically
# first free ip adress: &lt;x&gt;.&lt;y&gt;.&lt;z&gt;.3
# last free ip adress:  &lt;x&gt;.&lt;y&gt;.&lt;z&gt;.254
# broadcast adress:     &lt;x&gt;.&lt;y&gt;.&lt;z&gt;.255 (last adress of the adress space)
# this means we have up to 251 possible divice ips &#64; the subnet &lt;x&gt;.&lt;y&gt;.&lt;z&gt;
</span>dhcp-range<span class="operator">=</span>&lt;FIRST-FREE-IP&gt;,&lt;LAST-FREE-Ip&gt;,&lt;actual <span class="name builtin">time </span>the ip is reserved&gt;
</pre>
<p><a class="citation-reference" href="#bbb-ap" id="id4">[BBB-AP]</a></p>
</div>
</div>
<div class="section" id="gpio">
<h1><a class="toc-backref" href="#id41">9&nbsp;&nbsp;&nbsp;GPIO</a></h1>
<div class="figure align-center">
<img alt="img/BBB-pin-out.png" src="img/BBB-pin-out.png" />
</div>
<p><a class="citation-reference" href="#bbb-pin-out" id="id5">[BBB-PIN-OUT]</a></p>
<div class="figure align-center">
<img alt="img/GPIO-tester.jpg" src="img/GPIO-tester.jpg" />
</div>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="20%" />
<col width="32%" />
<col width="14%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head" colspan="5">P9</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>PIN</td>
<td>LABLE</td>
<td>Verbunden mit</td>
<td>PIN</td>
<td>LABLE</td>
</tr>
<tr><td>P9_01</td>
<td>GND</td>
<td>PIN_2 (GND)</td>
<td>P9_02</td>
<td>GND</td>
</tr>
<tr><td>P0_03</td>
<td>3,3V</td>
<td>PIN_1 (3,3V)</td>
<td>P9_04</td>
<td>3,3V</td>
</tr>
<tr><td>P9_05</td>
<td>5V RAW</td>
<td>&nbsp;</td>
<td>P9_06</td>
<td>5V RAW</td>
</tr>
<tr><td>P9_07</td>
<td>5V</td>
<td>&nbsp;</td>
<td>P9_08</td>
<td>5V</td>
</tr>
<tr><td>P9_09</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>P9_10</td>
<td>&nbsp;</td>
</tr>
<tr><td>P9_11</td>
<td>GPIO0_30</td>
<td>PIN_4 (Taster)</td>
<td>P9_12</td>
<td>GPIO1_28</td>
</tr>
<tr><td>P9_13</td>
<td>GPIO0_31</td>
<td>PIN_3 (LED)</td>
<td>P9_14</td>
<td>GPIO1_18</td>
</tr>
<tr><td>...</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>...</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
<div class="section" id="verwendung-des-sogenannten-sysfs">
<h2><a class="toc-backref" href="#id42">9.1&nbsp;&nbsp;&nbsp;Verwendung des sogenannten &quot;sysfs&quot;</a></h2>
<pre class="code bash literal-block">
<span class="comment"># Anlegen eines Deskriptors für den gewünschten Pin
</span>root&#64;arm:~# <span class="name builtin">echo</span> &lt;PIN#&gt; &gt; /sys/class/gpio/export

<span class="comment"># im GPIO Verzeichnis erscheint ein Verzeichnis für den Pin
</span>root&#64;arm:~# ls /sys/class/gpio/
<span class="name builtin">export  </span>gpio&lt;PIN#&gt;  gpiochip0  gpiochip32  gpiochip64  gpiochip96  unexport

<span class="comment"># für einen Test mit einer LED wird ein Ausgang benötigt
</span>root&#64;arm:~# <span class="name builtin">echo </span>out &gt; /sys/class/gpio/gpio&lt;PIN#&gt;/direction

<span class="comment"># Zuweisen einer logischen 1 am Pin führt dazu, das am Ausgang eine Spannung angelegt wird, nun sollte die LED leuchten
</span>root&#64;arm:~# <span class="name builtin">echo </span>1 &gt; /sys/class/gpio/gpio&lt;PIN#&gt;/value

<span class="comment"># Zum Ausschalten können nun die folgenden Befehle verwendet werden
</span><span class="name builtin">echo </span>0 &gt; /sys/class/gpio/gpio&lt;PIN#&gt;/value
<span class="name builtin">echo</span> &lt;PIN#&gt; &gt; /sys/class/gpio/unexport
</pre>
</div>
</div>
<div class="section" id="tools-und-programme">
<h1><a class="toc-backref" href="#id43">10&nbsp;&nbsp;&nbsp;Tools und Programme</a></h1>
<div class="section" id="minicom-ein-serial-terminal-emulator">
<h2><a class="toc-backref" href="#id44">10.1&nbsp;&nbsp;&nbsp;Minicom ein serial Terminal Emulator</a></h2>
<div class="section" id="installation">
<h3><a class="toc-backref" href="#id45">10.1.1&nbsp;&nbsp;&nbsp;Installation</a></h3>
<pre class="code bash literal-block">
<span class="comment"># for ubuntu / debian based distributions
</span>sudo apt-get install minicom

sudo minicom -s
</pre>
<p>Einstellungen des seriellen Anschlusses</p>
<div class="figure align-center">
<img alt="img/microcom-setup1.png" src="img/microcom-setup1.png" />
</div>
</div>
<div class="section" id="unter-a-das-richtige-device-einrichten">
<h3><a class="toc-backref" href="#id46">10.1.2&nbsp;&nbsp;&nbsp;Unter A das richtige Device einrichten</a></h3>
<div class="figure align-center">
<img alt="img/microcom-setup2.png" src="img/microcom-setup2.png" />
</div>
</div>
<div class="section" id="als-default-speichern">
<h3><a class="toc-backref" href="#id47">10.1.3&nbsp;&nbsp;&nbsp;Als default Speichern</a></h3>
<div class="figure align-center">
<img alt="img/microcom-setup3.png" src="img/microcom-setup3.png" />
</div>
</div>
<div class="section" id="minicom-beenden-und-neu-starten">
<h3><a class="toc-backref" href="#id48">10.1.4&nbsp;&nbsp;&nbsp;Minicom beenden und neu starten</a></h3>
<div class="figure align-center">
<img alt="img/microcom-setup4.png" src="img/microcom-setup4.png" />
</div>
</div>
</div>
<div class="section" id="fdisk-partitionierungs-tool">
<h2><a class="toc-backref" href="#id49">10.2&nbsp;&nbsp;&nbsp;fdisk partitionierungs tool</a></h2>
<p>&quot;fdisk&quot; ist das standard Partitionierungstool unter Linux ohne graphische Oberfläche. Mit wenigen Befehlen lässt sich so z.B. eine SD-Karte auf die Linux instalation vorbereiten.</p>
<div class="section" id="laufwerk-auswahlen">
<h3><a class="toc-backref" href="#id50">10.2.1&nbsp;&nbsp;&nbsp;Laufwerk auswählen</a></h3>
<p>öffnen eines Laufwerks (z.B. mmcblk0 für SD Karte)</p>
<pre class="code bash literal-block">
sudo fdisk /dev/mmcblk0
</pre>
</div>
<div class="section" id="laufwerksinformationen-ausgeben">
<h3><a class="toc-backref" href="#id51">10.2.2&nbsp;&nbsp;&nbsp;Laufwerksinformationen ausgeben</a></h3>
<ul class="simple">
<li>Auflisten der Partitionstabelle eines Laufwerks</li>
</ul>
<pre class="code bash literal-block">
sudo fdisk -lu /dev/mmcblk0

Disk /dev/mmcblk0: 14,7 GiB, 15811477504 bytes, 30881792 sectors
Units: sectors of 1 * <span class="name variable">512</span> <span class="operator">=</span> 512 bytes
Sector size <span class="operator">(</span>logical/physical<span class="operator">)</span>: 512 bytes / 512 bytes
I/O size <span class="operator">(</span>minimum/optimal<span class="operator">)</span>: 512 bytes / 512 bytes
Disklabel <span class="name builtin">type</span>: dos
Disk identifier: 0x00000000

Device         Boot Start      End  Sectors  Size Id Type
/dev/mmcblk0p1       8192 30881791 30873600 14,7G  c W95 FAT32 <span class="operator">(</span>LBA<span class="operator">)</span>
</pre>
</div>
<div class="section" id="sonstige-befehle">
<h3><a class="toc-backref" href="#id52">10.2.3&nbsp;&nbsp;&nbsp;Sonstige Befehle</a></h3>
<pre class="code bash literal-block">
DOS <span class="operator">(</span>MBR<span class="operator">)</span>
   a   toggle a bootable flag
   b   edit nested BSD disklabel
   c   toggle the dos compatibility flag

Generic
   d   delete a partition
   l   list known partition types
   n   add a new partition
   p   print the partition table
   t   change a partition <span class="name builtin">type
   </span>v   verify the partition table

Misc
   m   print this menu
   u   change display/entry units
   x   extra functionality <span class="operator">(</span>experts only<span class="operator">)</span>

Save &amp; Exit
   w   write table to disk and <span class="name builtin">exit
   </span>q   quit without saving changes

Create a new label
   g   create a new empty GPT partition table
   G   create a new empty SGI <span class="operator">(</span>IRIX<span class="operator">)</span> partition table
   o   create a new empty DOS partition table
   s   create a new empty Sun partition table
</pre>
</div>
<div class="section" id="unterschiedliche-formatierungen">
<h3><a class="toc-backref" href="#id53">10.2.4&nbsp;&nbsp;&nbsp;Unterschiedliche Formatierungen</a></h3>
<pre class="code bash literal-block">
Befehl <span class="operator">(</span>m für Hilfe<span class="operator">)</span>: l

 0  Leer            24  NEC DOS         81  Minix / altes L bf  Solaris
 1  FAT12           27  Hidden NTFS Win 82  Linux Swap / So c1  DRDOS/sec <span class="operator">(</span>FAT-
 2  XENIX root      39  Plan 9          83  Linux           c4  DRDOS/sec <span class="operator">(</span>FAT-
 3  XENIX usr       3c  PartitionMagic  84  OS/2 verst. C:- c6  DRDOS/sec <span class="operator">(</span>FAT-
 4  FAT16 &lt;32M      40  Venix 80286     85  Linux erweitert c7  Syrinx
 5  Erweiterte      41  PPC PReP Boot   86  NTFS Datenträge da  Keine Dateisyst
 6  FAT16           42  SFS             87  NTFS Datenträge db  CP/M / CTOS / …
 7  HPFS/NTFS/exFAT 4d  QNX4.x          88  Linux Klartext  de  Dell Dienstprog
 8  AIX             4e  QNX4.x 2. Teil  8e  Linux LVM       df  BootIt
 9  AIX bootfähig   4f  QNX4.x 3. Teil  93  Amoeba          e1  DOS-Zugriff
 a  OS/2-Bootmanage 50  OnTrack DM      94  Amoeba BBT      e3  DOS R/O
 b  W95 FAT32       51  OnTrack DM6 Aux 9f  BSD/OS          e4  SpeedStor
 c  W95 FAT32 <span class="operator">(</span>LBA<span class="operator">)</span> 52  CP/M            a0  IBM Thinkpad Ru eb  BeOS Dateisyste
 e  W95 FAT16 <span class="operator">(</span>LBA<span class="operator">)</span> 53  OnTrack DM6 Aux a5  FreeBSD         ee  GPT
 f  W95 Erw. <span class="operator">(</span>LBA<span class="operator">)</span>  54  OnTrackDM6      a6  OpenBSD         ef  EFI <span class="operator">(</span>FAT-12/16/
10  OPUS            55  EZ-Drive        a7  NeXTSTEP        f0  Linux/PA-RISC B
11  Verst. FAT12    56  Golden Bow      a8  Darwin UFS      f1  SpeedStor
12  Compaq Diagnost 5c  Priam Edisk     a9  NetBSD          f4  SpeedStor
14  Verst. FAT16 &lt;3 61  SpeedStor       ab  Darwin Boot     f2  DOS sekundär
16  Verst. FAT16    63  GNU HURD oder S af  HFS / HFS+      fb  VMware VMFS
17  Verst. HPFS/NTF 64  Novell Netware  b7  BSDi Dateisyste <span class="name builtin">fc  </span>VMware VMKCORE
18  AST SmartSleep  65  Novell Netware  b8  BSDI Swap       fd  Linux raid auto
1b  Verst. W95 FAT3 70  DiskSecure Mult bb  Boot-Assistent  fe  LANstep
1c  Verst. W95 FAT3 75  PC/IX           be  Solaris Boot    ff  BBT
1e  Verst. W95 FAT1 80  Altes Minix
</pre>
</div>
</div>
<div class="section" id="lighttpd-ein-leichtgewichtiger-http-server">
<h2><a class="toc-backref" href="#id54">10.3&nbsp;&nbsp;&nbsp;lighttpd - ein leichtgewichtiger http-server</a></h2>
<p><a class="citation-reference" href="#ltpd" id="id6">[LTPD]</a></p>
</div>
</div>
<div class="section" id="literatur-und-sonstige-quellen">
<h1><a class="toc-backref" href="#id55">11&nbsp;&nbsp;&nbsp;Literatur und sonstige Quellen</a></h1>
<table class="docutils citation" frame="void" id="bbb-ap" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[BBB-AP]</a></td><td>Wifi Accesspoint on a Beaglebone Black
<a class="reference external" href="https://fleshandmachines.wordpress.com/2012/10/04/wifi-acces-point-on-beaglebone-with-dhcp/">https://fleshandmachines.wordpress.com/2012/10/04/wifi-acces-point-on-beaglebone-with-dhcp/</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bbb-bsp" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[BBB-BSP]</a></td><td>Beaglebone Black Blockschaltpläne
<a class="reference external" href="http://linuxgizmos.com/beagleboard-x15-features-dual-core-cortex-a15-sitara/">http://linuxgizmos.com/beagleboard-x15-features-dual-core-cortex-a15-sitara/</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bbb-yocto" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[BBB-YOCTO]</a></td><td>Yocto Project Beaglebone Black
<a class="reference external" href="https://www.yoctoproject.org/downloads/bsps/daisy16/beaglebone">https://www.yoctoproject.org/downloads/bsps/daisy16/beaglebone</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="elin-bbb-os" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[ELIN-BBB-OS]</td><td>Beaglebone Black Operating Systems
<a class="reference external" href="http://elinux.org/BeagleBone_Operating_Systems">http://elinux.org/BeagleBone_Operating_Systems</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="elin-bbb-debian" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[ELIN-BBB-Debian]</td><td>Beaglebone Black Debian
<a class="reference external" href="http://elinux.org/BeagleBoardDebian">http://elinux.org/BeagleBoardDebian</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bbb-pin-out" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[BBB-PIN-OUT]</a></td><td>Pin-Out des Beaglebone Black
<a class="reference external" href="http://cholla.mmto.org/computers/beagle/hardware/pinout1-1024x585.png">http://cholla.mmto.org/computers/beagle/hardware/pinout1-1024x585.png</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="ltpd" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[LTPD]</a></td><td>lighttpd
<a class="reference external" href="http://www.lighttpd.net/">http://www.lighttpd.net/</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="tlwn" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[TLWN]</td><td>Wifi Driver for TL-WN725N V2
<a class="reference external" href="http://brilliantlyeasy.com/ubuntu-linux-tl-wn725n-tp-link-version-2-wifi-driver-install/">http://brilliantlyeasy.com/ubuntu-linux-tl-wn725n-tp-link-version-2-wifi-driver-install/</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="yocto" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[YOCTO]</td><td>Yocto Project Build
<a class="reference external" href="http://android.serverbox.ch/?p=1273">http://android.serverbox.ch/?p=1273</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="vics" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[VICS]</td><td>VI Cheat Sheet
<a class="reference external" href="http://www.lagmonster.org/docs/vi.html">http://www.lagmonster.org/docs/vi.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="todo" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[TODO]</a></td><td>Look for comments</td></tr>
</tbody>
</table>
<!-- vim: et sw=4 ts=4 -->
</div>
</div>
</body>
</html>
